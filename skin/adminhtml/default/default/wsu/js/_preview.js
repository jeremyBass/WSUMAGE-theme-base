/*! inline 0.0.1 2016-06-04 */
/*   */
!function(a){"use strict";a.wsu=a.wsu||{},a.wsu.product_preview={},a.wsu.product_preview.html_id=null,a.wsu.product_preview.iframe=null,a.wsu.product_preview.settings_default={parent:{show:"true",hideat:"",type:"flex-row","media-query-type":"column-at-480",size:"thirds-3","media-query-size":"",justification:"justify-start",content_alignment:"content-start"},child:{show:"true",hideat:"",size:"thirds-3",order:"order-1","media-query-size":"",item_alignment:"items-start"}},a.wsu.product_preview.cleanTarget=function(b,c){var d=["grid-","justify-","flex-","order-","full-width-","thirds-","fours-","fifths-","sixths-","eigths-","ninths-","tenths-","twelfths-","wrap","space-","center","column-","row-","hide-below-"];a.each(d,function(a,c){b.stripClass(c,!1)}),c()},a.wsu.product_preview._layoutItOut=function(b,c){var d=a.wsu.product_preview.iframe.contents();a.each(c,function(c,d){var e=a.wsu.product_preview.iframe.contents().find("."+c);e.length&&(e.addClass("preview_sortable"),a.wsu.product_preview.cleanTarget(e,function(){var b="true";if("undefined"!=typeof d.settings)if("undefined"!=typeof d.settings.show&&(b=""+("false"!==d.settings.show)),"false"===b)e.hide();else{e.show();var c="";a.each(d.settings,function(a,b){"show"!==a&&(c+=" "+b),"size"===a&&(c+=" grid-part "+b)}),e.addClass(c)}})),"undefined"!=typeof d.children&&a.wsu.product_preview._layoutItOut(b,d.children)}),a("#product_view_options li").off("mouseenter mouseleave"),a("#product_view_options li").hover(function(){var b=a(this).data("block");d.find(".product-view ."+b).addClass("preview_hovering")},function(){d.find(".preview_hovering").removeClass("preview_hovering")})},a.wsu.product_preview.set=function(b,c){for(var d=a.wsu.product_preview._layout,e=b.split("."),f=e.length,g=0;f-1>g;g++){var h=e[g];d[h]||(d[h]={}),d=d[h]}d[e[f-1]]=c},a.wsu.product_preview._updateLayout=function(){a("#product_view_options li").each(function(){a(this).children("dl").find("dd").each(function(){var b=a(this).data("path"),c=a(this).find(":input").val();a.wsu.product_preview.set(b,c)})}),a.wsu.product_preview._layoutItOut(a("."+a.wsu.product_preview.html_id),a.wsu.product_preview._layout),a("#"+a.wsu.product_preview.html_id).val(JSON.stringify(a.wsu.product_preview._layout))},a.wsu.product_preview._createInputForm=function(b,c){c=c||"";var d="<ul id='product_view_options'>",e={};return a.each(b,function(b,f){if(e={},d+="<li data-block='"+b+"'><b>"+b+"</b>","undefined"!=typeof f.settings){var g="";if("product_info"!==b&&"undefined"!=typeof f.children&&(d+="<span class='parent_option'>Options</span>",g="parent"),d+="<dl class='"+g+"'>","product_info"!==b){var h=a.wsu.product_preview.settings_default.child;if(e=a.extend({},h,f.settings),"undefined"!=typeof f.children){var i=a.wsu.product_preview.settings_default.parent;e=a.extend({},i,e)}}a.each(e,function(e,f){d+="<dt>"+e+"</dt>";var g=(""!==c?c+".":"")+b+".settings."+e;a(".type_"+e).find(":selected").attr("selected",!1),a(".type_"+e).find(":selected").removeAttr("selected"),a(".type_"+e).find("[value='"+f+"']").attr("selected",!0);var h=a(".type_"+e).html();d+="<dd data-classes='"+e+"' data-path='"+g+"'>"+h+"</dd>"}),d+="</dl>"}if("undefined"!=typeof f.children){var j=(""!==c?c+".":"")+b+".children";d+=a.wsu.product_preview._createInputForm(f.children,j)}d+="</li>"}),d+="</ul>"},a.wsu.product_preview.ajaxurl=null,a.wsu.product_preview.setupIframe=function(b){var c=a.wsu.product_preview.html_id.split("_");c.pop();var d=a("#"+c.join("_")+"-head");d.is(".open")?(b.off("load").on("load",function(){b.contents().find("head").append("<meta name='viewport' content='width=device-width, initial-scale=0.5'/>"),a.wsu.product_preview._layoutItOut(a("."+a.wsu.product_preview.html_id),a.wsu.product_preview._layout),b.contents().find("head").append(a("<style type='text/css'> .preview_sortable{ border:1px dashed rgba(0, 0, 0, 0); }  .preview_hovering{ border:1px dashed red; } </style>")),b.siblings(".refresh_iframe").removeClass("loading"),a("#product_view_options :input").on("change",function(){a.wsu.product_preview._updateLayout(a.wsu.product_preview._layout)})}),b.siblings(".refresh_iframe").addClass("loading"),""===a.wsu.product_preview.iframe.attr("src")&&a.wsu.product_preview.iframe.attr("src",a.wsu.product_preview.iframe.data("src")),a.wsu.product_preview.iframe.removeClass("iframeClose")):(b.off("load"),a.wsu.product_preview.iframe.attr("src",""),a.wsu.product_preview.iframe.addClass("iframeClose"))},a.wsu.product_preview.setup=function(b){a.wsu.product_preview.html_id=b,a.wsu.product_preview.iframe=a("iframe#layoutframeworkPreview_"+a.wsu.product_preview.html_id),a(document).ready(function(){var c=a("#"+b);if(c.closest("td").css("width","85%"),c.hide(),""!==c.val())try{var d=c.val(),e=JSON.parse(d);a.wsu.product_preview._layout=e}catch(f){console.error(f)}a("#row_"+b+" td.label").html(a.wsu.product_preview._createInputForm(a.wsu.product_preview._layout,""));var g=a("#product_view_options b");g.siblings("span").hide(),g.siblings("dl").hide(),g.siblings("ul").hide(),g.off().on("click",function(){var b=a(this);b.siblings("dl:not(.parent)").toggle(),b.siblings("ul").toggle(),b.siblings("span").toggle(),b.toggleClass("open","close"),b.is(".open")||(b.siblings(".parent_option").hide(),b.siblings(".parent").hide())}),a("#product_view_options .parent_option").off().on("click",function(){var b=a(this);b.siblings(".parent").toggle(),b.toggleClass("open","close")}),a.wsu.product_preview.setupIframe(a.wsu.product_preview.iframe);var h=a.wsu.product_preview.html_id.split("_");h.pop();var i=a("#"+h.join("_")+"-head");i.on("click",function(){a(this).is(".open")?console.log("opened"):console.log("closed"),a.wsu.product_preview.setupIframe(a.wsu.product_preview.iframe)}),null!==a.wsu.product_preview.ajaxurl&&a(".refresh_iframe").on("click",function(){a(this).addClass("loading"),a.getJSON(a.wsu.product_preview.ajaxurl).always(function(b){a(this).removeClass("loading"),a.wsu.product_preview.iframe.attr("src",b._url)})})}),a.wsu.product_preview._layout={product_info:{settings:{},children:{"product-essential":{settings:{type:"flex-row","media-query-type":"column-at-480"},children:{"product-content":{settings:{type:"flex-column",size:"fifths-3",order:"order-1","media-query-size":"full-width-at-480"},children:{"product-name":{settings:{show:"false"}},email_area:{settings:{order:"order-8"}},review_area:{settings:{order:"order-9"}},alert_urls_area:{settings:{order:"order-7"}},product_type_data_area:{settings:{order:"order-3"}},tier_price_area:{settings:{order:"order-4"}},extrahint_area:{settings:{order:"order-5"}},short_description_area:{settings:{order:"order-1"}},other_area:{settings:{type:"flex-column",order:"order-6"}},add_to_box:{settings:{type:"flex-column",order:"order-6"}},container1_area:{settings:{order:"order-2"},children:{"product-options":{settings:{order:"order-1"}},"product-options-bottom":{settings:{order:"order-2"}}}},description_area:{settings:{order:"order-10"}}}},product_info_media:{settings:{size:"fifths-2",order:"order-2","media-query-size":"full-width-at-480",type:"flex-row"},children:{"product-image":{settings:{size:"sixths-5",order:"order-2"}},"more-views":{settings:{size:"sixths-1",order:"order-1"},children:{"more-views-imgs":{settings:{type:"flex-column"}}}}}}}},"product-collateral":{}}}}}}(jQuery);